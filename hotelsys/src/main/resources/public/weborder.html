<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title> Rooms</title>
<link href="test/bootstrap.css" rel="stylesheet" type="text/css">
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<!-- Custom Theme files -->
<link href="test/style.css" rel="stylesheet" type="text/css">
<!-- Custom Theme files -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="keywords" content="">
<script type="application/x-javascript"> 
	addEventListener("load", function() { 
		setTimeout(hideURLbar, 0); 
		}, false); 
	function hideURLbar(){ 
		window.scrollTo(0,1); 
		} 
</script>
<!--webfont-->
<link href="https://fonts.useso.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
<script type="text/javascript" src="test/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="test/login.js"></script>
<script src="test/jquery.easydropdown.js"></script>
<script src="test/wow.min.js"></script>
<link href="test/animate.css" rel="stylesheet" type="text/css">
<link href="css/order.css" rel="stylesheet" type="text/css">

</head>
<body>
	<div id="app">
		
<div class="header">
		   <div class="col-sm-8 header-left">
					 <div class="logo">
						<a href="#"><img src="test/logo.png" alt=""></a>
					 </div>
					 <div class="menu">
						<a class="toggleMenu" href="#" style="display: none;"><img src="img/nav.png" alt=""></a>
						  <ul class="nav" id="nav">
						  	<li><a href="webindex.html">酒店</a></li>
						  	<li><a href="room.html">客房</a></li>
						  	<li><a href="webgonggao.html">公告</a></li>
						  	<li class="active"><a href="weborder.html">我的订单</a></li>
							<div class="clearfix"></div>
						</ul>
						<script type="text/javascript" src="test/responsive-nav.js"></script>
				    </div>	
				     <!-- start search-->
				      
						<!----//search-scripts---->						
	    		    <div class="clearfix"> </div>
	    	    </div>
	          <div class="col-sm-4 header_right" >
	    		      <div id="loginContainer"><a id="loginButton"><img src="img/login.png"><span>{{temp}}</span></a>
	    		      <a id="regButton"><img src="img/login.png"><span>注册</span></a>
						    <div id="loginBox" style="display: none;">                
						        <form id="loginForm">
						                <fieldset id="body">
						                	<fieldset>
						                          <label for="email">账号</label>
						                          <input type="text" v-model="yh.yid">
						                    </fieldset>
						                    <fieldset>
						                            <label for="password">密码</label>
						                            <input type="password" name="password" id="yh.pwd" v-model="yh.pwd">
						                     </fieldset>
						                    <input type="button" id="login" value="登录" @click="login">
						                	<label for="checkbox"><input type="checkbox" id="checkbox"> <i>记住密码</i></label>
						            	</fieldset>
						                 <span><a href="#">忘记密码?</a></span>
							      </form>
				              </div>
						    <div id="loginBox" style="display: none;">                
						        <form id="loginForm">
						                <fieldset id="body">
						                	<fieldset>
						                          <label for="email">账号</label>
						                          <input type="text" v-model="y.yid">
						                    </fieldset>
						                	<fieldset>
						                          <label for="email">姓名</label>
						                          <input type="text" v-model="y.name">
						                    </fieldset>
						                    <fieldset>
						                            <label for="password">密码</label>
						                            <input type="password" name="password" id="y.pwd" v-model="y.pwd">
						                     </fieldset>
						                	<fieldset>
						                          <label for="email">电话</label>
						                          <input type="text" v-model="y.tel">
						                    </fieldset>
						                	<fieldset>
						                          <label for="email">邮箱</label>
						                          <input type="text" v-model="y.email">
						                    </fieldset>
						                	<fieldset>
						                          <label for="email">身份证</label>
						                          <input type="text" v-model="y.idcard">
						                    </fieldset>
						                    <input type="button" id="login" value="注册" @click="reg">
						            	</fieldset>
							      </form>
				              </div>
			             </div>
		                 <div class="clearfix"></div>
	                 </div>
	                 
	                <div class="clearfix"></div>
				</div>
	              
   
   	 
   	 
   <div class="living_middle">
   	  <div class="container">
   	  	
		<div class="col-md-3 wow fadeInLeft animated" data-wow-delay="0.4s" style="visibility: visible; animation-delay: 0.4s; animation-name: fadeInLeft;">
   	    		
   	    	<div class="living_box">
   	    		<h2 style="margin-left:-20px">个人信息</h2>
   	    		<span style="color: red">{{msg}}</span>
   	    		<ul style="list-style: none;margin: 0;padding: 0;margin-left:20px">
   	    			<li><label>编&nbsp;&nbsp;号&nbsp;：</label>{{obj.yid}}</li>
   	    			<li><label>姓&nbsp;&nbsp;名&nbsp;：</label>{{obj.name}}</li>
   	    			<li><label>电&nbsp;&nbsp;话&nbsp;：</label>{{obj.tel}}</li>
   	    			<li><label>Email&nbsp;：</label>{{obj.email}}</li>
   	    			<li><label>身份证&nbsp;：</label>{{obj.idcard}}</li>
   	    			
   	    			<li><input type="button" value="修改个人信息" @click="update"></li>
   	    		</ul>
   	    	</div>
   	    	
   	    	
   	    	<div v-if="updateInfo" class="living_box">
   	    		<h2 style="margin-left:-20px">修改个人信息</h2>
   	    		<span style="color: red">{{msg}}</span>
   	    		<ul style="list-style: none;margin: 0;padding: 0;margin-left:20px">
   	    			
   	    			<li><label>姓&nbsp;&nbsp;名&nbsp;：</label><input v-model="yh1.name"/></li>
   	    			<li><label>电&nbsp;&nbsp;话&nbsp;：</label><input v-model="yh1.tel"/></li>
   	    			<li><label>Email&nbsp;：</label><input v-model="yh1.email"/></li>
   	    			<li><label>身份证&nbsp;：</label><input v-model="yh1.idcard"/></li>
   	    			<li><input type="button" value="修改" @click="update1"></li>
   	    		</ul>
   	    	</div>
   	    	
   	    	
		 </div>
		  
		  <div class="col-md-9 wow fadeInLeft animated" data-wow-delay="0.4s" style="visibility: visible; animation-delay: 0.4s; animation-name: fadeInLeft;background:white">
   	    	<div class="living_box" style="font-size:16px;min-height:600px">
			   <h2 class="title block-title" style="text-align:left">我的订单</h2>
   	   
			 
			  <div id="con">
			   	<ul id="ord">
			   		<li class="w">房间类型</li>
			   		<li class="w">开始时间</li>
			   		<li class="w">离店时间</li>
			   		<li>单价</li>
			   		<li>总价</li>
			   		<li>状态</li>
			   	</ul>
			   	
			   <ul id="ord" v-for="o in orders">
			   	<li class="w"><img src="img/pic1.jpg" width="50px" height="50px" >
			   	<span>{{o.tname}}</span></li>
			   	<li class="w"><span>{{o.start}}</span></li>
			   	<li class="w"><span>{{o.end}}</span></li>
			   	<li><span>{{o.price}}</span></li>
			   	<li><span>{{o.total}}</span></li>
			   	<li><span v-if="o.temp==1">未确认</span></li>
			   	<li><span v-if="o.temp==2">已确认</span></li>
			   </ul>
			   
			   </div>	
			    
			</div>
		 </div>
		 
		 
   	    </div>
   </div>
  
  
  <div class="footer" style="background-color:black">
   	<div class="container">
   	 
	  <div class="footer_grids">
	     <div class="footer-grid">
			<h4>Ipsum Quis</h4>
			<ul class="list1">
				<li><a href="#">Contact</a></li>
				<li><a href="#">Mirum est</a></li>
				<li><a href="#">Placerat facer</a></li>
				<li><a href="#">Claritatem</a></li>
				<li><a href="#">Sollemnes </a></li>
			</ul>
		  </div>
		  <div class="footer-grid">
			<h4>Quis Ipsum</h4>
			<ul class="list1">
				<li><a href="#">Placerat facer</a></li>
				<li><a href="#">Claritatem</a></li>
				<li><a href="#">Sollemnes </a></li>
				<li><a href="#">Claritas</a></li>
				<li><a href="#">Mirum est</a></li>
			</ul>
		  </div>
		  <div class="footer-grid last_grid">
			<h4>Follow Us</h4>
			<ul class="footer_social wow fadeInLeft animated" data-wow-delay="0.4s" style="visibility: visible; animation-delay: 0.4s; animation-name: fadeInLeft;">
			  <li><a href="#"> <i class="fb"> </i> </a></li>
			  <li><a href="#"><i class="tw"> </i> </a></li>
			  <li><a href="#"><i class="google"> </i> </a></li>
			  <li><a href="#"><i class="u_tube"> </i> </a></li>
		 	</ul>
		 	<div class="copy wow fadeInRight animated" data-wow-delay="0.4s" style="visibility: visible; animation-delay: 0.4s; animation-name: fadeInRight;">
              <p>Copyright © 2020.Company name All rights reserved.</p>
	        </div>
		  </div>
		  <div class="clearfix"> </div>
	   </div>
	   
      </div>
   </div>
   
   </div>				
	<script type="text/javascript" src="js/vue.min.js"></script>
	<script type="text/javascript" src="js/axios.min.js"></script>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script src="js/base.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		let vm = new Vue({
			el:'#app',
			data:{
				orders:[],
				orders1:[],
				temp:"登录",
				y:{},
				obj:{},
				yh:{},
				yh1:{},
				msg:'',
				updateInfo: false
			},
			created(){
	        	let obj1 = JSON.parse(sessionStorage.getItem('yh'));
	        	if(obj1!=null){
					//this.order.yid = obj1.yid;
					this.obj = obj1;
					this.getOrders(obj1.yid);
					this.temp = "欢迎 "+this.obj.name+" 登录";
				}else{
					this.msg = "请先登录";
				}
			},
			methods:{
				getOrders:function(yid){
					let that = this;
					axios.post("horder/selectListByYid?yid="+yid).then(res=>{
						that.orders1 =  [
							             {tname:'1',start:'1',end:'1'},
							             {tname:'2',start:'2',end:'2'},
							             {tname:'3',start:'1',end:'1'}
							             
							             ];
						vm.orders = res.data;
					});
				},
			    login:function(){
					axios.post("yonghu/selectOne?yid="+vm.yh.yid).then(res=>{
						//alert(JSON.stringify(res.data));
						let yg = res.data;
						if(yg!=null&&yg.pwd==vm.yh.pwd){
							this.msg = "登录成功!";
							vm.temp="欢迎 "+this.obj.name+" 登录";
							sessionStorage.setItem('yh',JSON.stringify(yg));
							location.reload();
						}else{
							vm.temp="登录";
						}
					});
				},
			    reg:function(){
					axios.post("yonghu/insert", this.y).then(res=>{
						if(res.data){
							this.msg = "注册成功!";
						}else{
							this.msg = "注册失败!";
						}
					});
				},
				delOrd:function(oid,index){
					let result = confirm("确认删除吗？");
					if(result){
						axios.post("horder/delete?oid="+oid).then(res=>{
							if(res.data=='1'){
								vm.orders.splice(index,1);
							}
						});
					}
				},
				update:function(){
					this.updateInfo = true;
					this.yh1 = this.obj;
				},
				update1:function(){
					let that = this;
					//alert(JSON.stringify(that.yh1));
					axios.post("yonghu/update",that.yh1).then(res=>{
						if(res.data=="1"){
							alert('修改成功');
							that.updateInfo = false;
							//vm.yh.yid = that.yh1.yid;
							vm.yh = that.yh1;
							sessionStorage.setItem('yh',JSON.stringify(vm.yh));
							that.login();	
						}else{
							alert('修改失败');
						}
					});
				}
				
			}
		})
	</script>					
</body>
</html>